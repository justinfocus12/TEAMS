
This repository contains code for running the TEAMS algorithm, as well as more general ensemble-generating procedures for dynamical systems. Among the included examples are the Frierson GCM featured in Finkel & O'Gorman (2025), as well as the Lorenz-96 system featured in Finkel & O'Gorman (2024). The summary below is meant to convey the general design of the codebase, which aims to be extensible to new algorithms and new dynamical systems. But the implementation is not professional, and will certainly need case-by-case modification. Interested readers are highly encouraged to contact Justin Finkel (justinfocus12@gmail.com) for guidance on using it. Still, we hope that the core ideas conveyed here, in the publications, and in the code structure will help to facilitate community uptake of our methods. 

I. The driver code hierarchy: dynamical systems and algorithms for running them in ensemble mode
    A. DynamicalSystem class (dynamicalsystem.py): specification of required methods for defining any new system, such as "run_trajectory" and "generate_default_icandf" (icandf = initial conditions and forcing). The same file implements "ODESystem" and "SDESystem" for ordinary and stochastic differential equations. Both of those must be specified further for particular systems, such as Lorenz-96 as done in the examples. If ">" means "is a superclass of", DynamicalSystem > SDESystem > Lorenz96. For the Frierson GCM, more customization is necessary, and so the instantiation "FriersonGCM" implemented in examples/frierson_gcm directly extends DynamicalSystem: DynamicalSystem > FriersonGCM. 
    B. Ensemble class (ensemble.py) specifies a data structure for managing large, and growing, ensembles of simulations stored on the disk. It is agnostic to the type of dynamical system. 
    C. EnsembleAlgorithm class (algorithms.py): in general, an EnsembleAlgorithm is a rule for generating the next member in an Ensemble given its current state. TEAMS is one example; DNS is another example with a very simple rule of extending the previous simulation chunk, picking it up at the endpoint; and "PeriodicBranching" is another example that we used to calculate ensemble dispersion rates in Finkel and O'Gorman (2025). Each of these is specified as a still-abstract subclass in the algorithms.py file, and the concrete implementations are completed in the examples subfolder. E.g., FriersonGCMTEAMS < TEAMS < EnsembleAlgorithm, and Lorenz96TEAMS < SDETEAMS < TEAMS < EnsembleAlgorithm.
II. The Lorenz96 system
III. The Frierson GCM 
IV.  TEAMS on the Frierson GCM
V.   PeriodicBranching on the Frierson GCM
